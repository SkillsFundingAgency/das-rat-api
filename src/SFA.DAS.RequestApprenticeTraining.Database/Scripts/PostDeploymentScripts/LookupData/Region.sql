/*
	Insert or Update each of the [Region] look up default values.

	NOTES:

	1) This script uses a temporary table, insert or update the values in the temporary table to apply changes; removed values will
	not take affect (by design) as they may still be referenced by rows in the database.
*/
BEGIN TRANSACTION

CREATE TABLE #Region(
    [SubregionName] VARCHAR(250) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
    [RegionName] VARCHAR(25) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
    [Latitude] FLOAT NOT NULL,
    [Longitude] FLOAT NOT NULL
) 

INSERT #Region VALUES ('Derby','East Midlands',52.9219,-1.47564)
INSERT #Region VALUES ('Derbyshire','East Midlands',52.9219,-1.47564)
INSERT #Region VALUES ('Leicester','East Midlands',52.6349,-1.12906)
INSERT #Region VALUES ('Leicestershire','East Midlands',52.6349,-1.12906)
INSERT #Region VALUES ('Lincolnshire','East Midlands',52.9452,-0.1601)
INSERT #Region VALUES ('Northamptonshire','East Midlands',52.2348,-0.89732)
INSERT #Region VALUES ('Nottingham','East Midlands',52.9551,-1.14917)
INSERT #Region VALUES ('Nottinghamshire','East Midlands',52.9551,-1.14917)
INSERT #Region VALUES ('Rutland','East Midlands',52.6583,-0.6396)
INSERT #Region VALUES ('Bedford','East of England',52.1357,-0.46804)
INSERT #Region VALUES ('Cambridgeshire','East of England',52.5734,-0.24846)
INSERT #Region VALUES ('Central Bedfordshire','East of England',52.0027,-0.29749)
INSERT #Region VALUES ('Essex','East of England',51.5742,-0.4857)
INSERT #Region VALUES ('Hertfordshire','East of England',51.8098,-0.2377)
INSERT #Region VALUES ('Luton','East of England',51.8796,-0.41756)
INSERT #Region VALUES ('Norfolk','East of England',52.614,0.8864)
INSERT #Region VALUES ('Peterborough','East of England',52.5734,-0.24846)
INSERT #Region VALUES ('Southend-on-Sea','East of England',51.5404,0.7077)
INSERT #Region VALUES ('Suffolk','East of England',52.1872,0.9708)
INSERT #Region VALUES ('Thurrock','East of England',51.4935,0.3529)
INSERT #Region VALUES ('Barking and Dagenham','London',51.5363,0.08148)
INSERT #Region VALUES ('Barnet','London',51.6529,-0.19961)
INSERT #Region VALUES ('Bexley','London',51.4414,0.14861)
INSERT #Region VALUES ('Brent','London',51.5673,-0.2711)
INSERT #Region VALUES ('Bromley','London',51.4057,0.01435)
INSERT #Region VALUES ('Camden','London',51.5517,-0.1588)
INSERT #Region VALUES ('City of London','London',51.5363,0.08148)
INSERT #Region VALUES ('Croydon','London',51.3724,-0.0982)
INSERT #Region VALUES ('Ealing','London',51.5133,-0.08153)
INSERT #Region VALUES ('Greenwich','London',51.4934,0.0098)
INSERT #Region VALUES ('Hackney','London',51.5734,-0.0724)
INSERT #Region VALUES ('Hammersmith and Fulham','London',51.499,-0.2291)
INSERT #Region VALUES ('Haringey','London',51.5906,-0.111)
INSERT #Region VALUES ('Harrow','London',51.5788,-0.33376)
INSERT #Region VALUES ('Havering','London',51.5779,0.2121)
INSERT #Region VALUES ('Hillingdon','London',51.5336,-0.45258)
INSERT #Region VALUES ('Hounslow','London',51.4676,-0.3618)
INSERT #Region VALUES ('Islington','London',51.5465,-0.1058)
INSERT #Region VALUES ('Kensington and Chelsea','London',51.4991,-0.1938)
INSERT #Region VALUES ('Kingston upon Thames','London',51.4123,-0.30044)
INSERT #Region VALUES ('Lambeth','London',51.4571,-0.1231)
INSERT #Region VALUES ('Lewisham','London',51.4415,-0.0117)
INSERT #Region VALUES ('Merton','London',51.4098,-0.2108)
INSERT #Region VALUES ('Newham','London',51.5255,0.0352)
INSERT #Region VALUES ('Redbridge','London',51.5901,0.0819)
INSERT #Region VALUES ('Richmond upon Thames','London',51.4613,-0.30044)
INSERT #Region VALUES ('Southwark','London',51.5028,-0.0877)
INSERT #Region VALUES ('Sutton','London',51.3605,-0.19178)
INSERT #Region VALUES ('Tower Hamlets','London',51.5203,-0.0293)
INSERT #Region VALUES ('Waltham Forest','London',51.5886,-0.0118)
INSERT #Region VALUES ('Wandsworth','London',51.4571,-0.1818)
INSERT #Region VALUES ('Westminster','London',51.4975,-0.1357)
INSERT #Region VALUES ('County Durham','North East',54.7787,-1.55961)
INSERT #Region VALUES ('Darlington','North East',54.5287,-54.5287)
INSERT #Region VALUES ('Gateshead','North East',54.9594,-1.60182)
INSERT #Region VALUES ('Hartlepool','North East',54.6825,-1.2167)
INSERT #Region VALUES ('Middlesbrough','North East',54.573,-1.23791)
INSERT #Region VALUES ('Newcastle upon Tyne','North East',54.9778,-1.61292)
INSERT #Region VALUES ('North Tyneside','North East',55.0182,1.4858)
INSERT #Region VALUES ('Northumberland','North East',55.2083,-2.0784)
INSERT #Region VALUES ('Redcar and Cleveland','North East',54.603,-1.07763)
INSERT #Region VALUES ('South Tyneside','North East',54.9637,-1.4419)
INSERT #Region VALUES ('Stockton-on-Tees','North East',54.5682,-1.31443)
INSERT #Region VALUES ('Sunderland','North East',54.9044,-1.38145)
INSERT #Region VALUES ('Blackburn with Darwen','North West',53.7501,-2.48471)
INSERT #Region VALUES ('Blackpool','North West',53.8142,-3.05354)
INSERT #Region VALUES ('Bolton','North West',53.5785,-2.42984)
INSERT #Region VALUES ('Bury','North West',53.5935,-2.29854)
INSERT #Region VALUES ('Cheshire East','North West',53.161,-2.2186)
INSERT #Region VALUES ('Cheshire West and Chester','North West',53.2174,-2.74297)
INSERT #Region VALUES ('Cumbria','North West',54.5772,-2.7975)
INSERT #Region VALUES ('Halton','North West',53.3613,-2.7335)
INSERT #Region VALUES ('Knowsley','North West',53.4546,-2.8529)
INSERT #Region VALUES ('Lancashire','North West',53.5412,-2.11766)
INSERT #Region VALUES ('Liverpool','North West',53.4108,-2.97784)
INSERT #Region VALUES ('Manchester','North West',53.4807,-2.23438)
INSERT #Region VALUES ('Oldham','North West',53.5412,-2.11766)
INSERT #Region VALUES ('Rochdale','North West',53.6163,-2.15871)
INSERT #Region VALUES ('Salford','North West',53.4875,-2.2901)
INSERT #Region VALUES ('Sefton','North West',53.5034,-2.9704)
INSERT #Region VALUES ('St Helens','North West',53.4539,-2.73689)
INSERT #Region VALUES ('Stockport','North West',53.4085,-2.14929)
INSERT #Region VALUES ('Tameside','North West',53.4806,-2.081)
INSERT #Region VALUES ('Trafford','North West',53.4707,-2.3231)
INSERT #Region VALUES ('Warrington','North West',53.3927,-2.587)
INSERT #Region VALUES ('Wigan','North West',53.5443,-2.63106)
INSERT #Region VALUES ('Wirral','North West',53.3727,-3.0738)
INSERT #Region VALUES ('Bracknell Forest','South East',51.4154,-0.7536)
INSERT #Region VALUES ('Brighton and Hove','South East',50.8302,-0.1372)
INSERT #Region VALUES ('Buckinghamshire','South East',51.8137,-0.8095)
INSERT #Region VALUES ('East Sussex','South East',50.9086,-0.2494)
INSERT #Region VALUES ('Hampshire','South East',51.0577,-1.3081)
INSERT #Region VALUES ('Isle of Wight','South East',50.6938,-1.3047)
INSERT #Region VALUES ('Kent','South East',51.2787,0.5217)
INSERT #Region VALUES ('Medway','South East',51.4047,0.5418)
INSERT #Region VALUES ('Milton Keynes','South East',52.0414,-0.76056)
INSERT #Region VALUES ('Oxfordshire','South East',51.7537,-1.26346)
INSERT #Region VALUES ('Portsmouth','South East',50.7989,-1.09116)
INSERT #Region VALUES ('Reading','South East',51.455,-0.9781)
INSERT #Region VALUES ('Slough','South East',51.5093,-0.59545)
INSERT #Region VALUES ('Southampton','South East',50.905,-1.40323)
INSERT #Region VALUES ('Surrey','South East',51.3148,-0.56)
INSERT #Region VALUES ('West Berkshire','South East',51.4308,-1.1445)
INSERT #Region VALUES ('West Sussex','South East',50.8366,-0.4617)
INSERT #Region VALUES ('Windsor and Maidenhead','South East',51.4847,-0.64786)
INSERT #Region VALUES ('Wokingham','South East',51.411,-0.83493)
INSERT #Region VALUES ('Bath and North East Somerset','South West',51.3476,-2.4766)
INSERT #Region VALUES ('Bournemouth','South West',50.7217,-1.87853)
INSERT #Region VALUES ('Bristol','South West',51.4545,-2.5879)
INSERT #Region VALUES ('Cornwall','South West',50.266,-5.0527)
INSERT #Region VALUES ('Devon','South West',50.7156,-3.5309)
INSERT #Region VALUES ('Dorset','South West',50.7488,-2.3445)
INSERT #Region VALUES ('Gloucestershire','South West',51.8667,-2.24867)
INSERT #Region VALUES ('Isles of Scilly','South West',49.9146,-6.31574)
INSERT #Region VALUES ('North Somerset','South West',51.3879,-2.7781)
INSERT #Region VALUES ('Plymouth','South West',50.3704,-4.14265)
INSERT #Region VALUES ('Poole','South West',50.7194,-1.98114)
INSERT #Region VALUES ('Somerset','South West',51.1051,-2.9262)
INSERT #Region VALUES ('South Gloucestershire','South West',51.5264,-2.4728)
INSERT #Region VALUES ('Swindon','South West',51.5584,-1.78204)
INSERT #Region VALUES ('Torbay','South West',50.4619,-3.5253)
INSERT #Region VALUES ('Wiltshire','South West',51.3492,-1.9927)
INSERT #Region VALUES ('Birmingham','West Midlands',52.4829,-1.89346)
INSERT #Region VALUES ('Coventry','West Midlands',52.4063,-1.50852)
INSERT #Region VALUES ('Dudley','West Midlands',52.5087,-2.08734)
INSERT #Region VALUES ('Herefordshire','West Midlands',52.0765,-2.6544)
INSERT #Region VALUES ('Sandwell','West Midlands',52.5064,-1.96258)
INSERT #Region VALUES ('Shropshire','West Midlands',52.6759,-2.4497)
INSERT #Region VALUES ('Solihull','West Midlands',52.4147,-1.7743)
INSERT #Region VALUES ('Staffordshire','West Midlands',52.8793,-2.0572)
INSERT #Region VALUES ('Stoke-on-Trent','West Midlands',53.0258,-2.17739)
INSERT #Region VALUES ('Telford and Wrekin','West Midlands',52.741,-2.4869)
INSERT #Region VALUES ('Walsall','West Midlands',52.5859,-1.98229)
INSERT #Region VALUES ('Warwickshire','West Midlands',52.2819,-1.58447)
INSERT #Region VALUES ('Wolverhampton','West Midlands',52.5853,-2.13192)
INSERT #Region VALUES ('Worcestershire','West Midlands',52.192,-2.22353)
INSERT #Region VALUES ('Barnsley','Yorkshire and The Humber',53.5529,-1.48127)
INSERT #Region VALUES ('Bradford','Yorkshire and The Humber',53.7938,-1.75244)
INSERT #Region VALUES ('Calderdale','Yorkshire and The Humber',53.7248,-1.8658)
INSERT #Region VALUES ('Doncaster','Yorkshire and The Humber',53.523,-1.13376)
INSERT #Region VALUES ('East Riding of Yorkshire','Yorkshire and The Humber',53.8429,-0.42766)
INSERT #Region VALUES ('Kingston upon Hull','Yorkshire and The Humber',53.7443,-0.33244)
INSERT #Region VALUES ('Kirklees','Yorkshire and The Humber',53.5933,-1.801)
INSERT #Region VALUES ('Leeds','Yorkshire and The Humber',53.7997,-1.5491)
INSERT #Region VALUES ('North East Lincolnshire','Yorkshire and The Humber',53.5668,-0.0815)
INSERT #Region VALUES ('North Lincolnshire','Yorkshire and The Humber',53.6056,-0.5597)
INSERT #Region VALUES ('North Yorkshire','Yorkshire and The Humber',53.9915,-1.5412)
INSERT #Region VALUES ('Rotherham','Yorkshire and The Humber',53.4302,-1.35685)
INSERT #Region VALUES ('Sheffield','Yorkshire and The Humber',53.3831,-1.46479)
INSERT #Region VALUES ('Wakefield','Yorkshire and The Humber',53.683,-1.4991)
INSERT #Region VALUES ('York','Yorkshire and The Humber',53.96,-1.0873)
INSERT #Region VALUES ('Enfield','London',51.6521,-0.08153)

MERGE [Region] [Target] USING #Region [Source]
ON ([Source].[SubregionName] = [Target].[SubregionName] AND [Source].[RegionName] = [Target].[RegionName])
WHEN MATCHED
    THEN UPDATE SET 
        [Target].[Latitude] = [Source].[Latitude],
        [Target].[Longitude] = [Source].[Longitude]

WHEN NOT MATCHED BY TARGET 
    THEN INSERT ([SubregionName], [RegionName], [Latitude], [Longitude] )
         VALUES ([Source].[SubregionName], [Source].[RegionName], [Source].[Latitude], [Source].[Longitude]);

COMMIT TRANSACTION
